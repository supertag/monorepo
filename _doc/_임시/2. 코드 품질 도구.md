# VS Code에서 ESLint & Prettier 함께 사용하기

코드 품질 검사(ESLint)와 코드 스타일 자동 정리(Prettier) 를 동시에 적용

(참고) eslint를 사용할 때 prettier의 설정(.prettierrc file 사용 방법  
https://heewon26.tistory.com/262

## 설치

모노레포에서 ESLint & Prettier 설정은 최상위(루트)에서 한 번만 설정하면 됨  
각 하위 패키지(워크스페이스)에서도 필요하면 추가적인 설정을 덮어쓸 수 있음.

- VS Code 확장 도구만으로도 기본적인 포맷팅은 가능하지만, 프로젝트 폴더에 prettier 패키지를 설치하는 것이 더 일관성이 있고 안정적임 (vscode 버전, extension 버전, Prettier 버전)

- eslint-config-prettier와 함께 사용하려면 prettier 패키지가 필요함.

```sh
// eslint-plugin-prettier는 사용하지 않음
pnpm add -D -w eslint prettier eslint-config-prettier

# eslint.config.(m)js
# npm init @eslint/config@latest
npm init @eslint/config@latest --config eslint-config-standard

npm install
eslint
eslint-plugin-unused-imports
@typescript-eslint/parser
@typescript-eslint/eslint-plugin


```

버전명 꺽쇠를 삭제하여 버전을 고정시킴

```json
"devDependencies": {
    "eslint": "9.20.1", // "^9.20.1"
    "eslint-config-prettier": "10.0.1", // "^10.0.1"
    "prettier": "3.5.1" // "^3.5.1"
  }
```

### prettier 설정 (`.prettierrc` 및 `.prettierignore`) 파일

- `.prettierrc` 파일은 prettier의 코드 옵션을 가지고 있는 파일
- `.prettierignore` 파일은 prettier 코드 옵션에 제외할 내용을 담을 파일 정보를 가지고 있는 파일

```json
{
  // 여러 줄을 사용할 때, 후행 콤마 사용 방식
  "trailingComma": "es5",
  // 화살표 함수의 매개변수가 하나일 때 괄호를 사용할지 여부
  "arrowParens": "always",
  // 객체 리터럴에서 중괄호 내부에 공백 삽입할지 여부
  "bracketSpacing": true,
  // EoF 방식, OS별로 처리 방식이 다름
  "endOfLine": "auto",
  // HTML 공백 감도 설정
  "htmlWhitespaceSensitivity": "css",
  // JSX에 singe 쿼테이션 사용 여부
  "jsxSingleQuote": false,
  // 한 줄에 출력되는 코드의 최대 길이
  "printWidth": 80,
  // markdown 텍스트의 줄바꿈 방식 (v1.8.2)
  "proseWrap": "preserve",
  // 객체 속성에 쿼테이션 적용 방식
  "quoteProps": "as-needed",
  // 세미콜론 사용 여부
  "semi": true,
  // single 쿼테이션 사용 여부
  "singleQuote": true,
  // 사용할 parser를 지정, 자동으로 지정됨
  // "parser": "",
  // parser를 유추할 수 있는 파일을 지정
  // "filepath": "",
  // 포맷팅을 부분 적용할 파일의 시작 라인 지정
  // "rangeStart": 0,
  // 포맷팅 부분 적용할 파일의 끝 라인 지정,
  // "rangeEnd": "Infinity",
  // 파일 상단에 미리 정의된 주석을 작성하고 Pragma로 포맷팅 사용 여부 지정
  // "requirePragma": false,
  // 미리 정의된 @format marker의 사용 여부 (v1.8.0)
  // "insertPragma": false,
  // Prettier 설정 강제 적용
  // "requireConfig": true,
  "tabWidth": 4,
  "useTabs": true,
  // Vue 파일의 script와 style 태그의 들여쓰기 여부 (v1.19.0)
  "vueIndentScriptAndStyle": true
}
```

### eslintrc 설정 (`.eslintrc.json`) 파일

```json
{
  // 하위 패키지들은 이 설정을 그대로 상속받음.
  "root": true,

  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:prettier/recommended"
  ],
  "plugins": ["@typescript-eslint", "prettier"],
  "rules": {
    "prettier/prettier": "error",
    "no-unused-vars": "warn",
    "no-console": "warn"
  },
  "overrides": [
    {
      "files": ["*.ts", "*.tsx"],
      "extends": ["plugin:@typescript-eslint/recommended"]
    }
  ]
}
```

각 패키지에서 별도 설정이 필요할 때 폴더에 추가로 설정 (`.eslintrc.json`) 파일을 생성하고 `extends`로 루트 설정을 불러온 후 덮어쓰기 가능함

예시: `apps/web/.eslintrc.json` (하위 패키지별 추가 설정)

```json
"extends": "../../.eslintrc.json",
```

## vscode 설정 (`setting.json`) 파일

eslint-plugin-prettier를 사용하지 않는다면 vscode의 setting.json에 defaultFormatter를 prettier로 설정해 줌

```json
{
  // formatter
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true,
  "editor.formatOnPaste": true,
  "editor.formatOnType": true,
  // ...

  // eslint
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "always" // eslint가 파일이 저장될 때 자동수정
  },
  "eslint.validate": [
    "vue",
    "javascript",
    "javascriptreact",
    "typescript",
    "typescriptreact"
  ],

  // 보통 이렇게 디렉토리 설정을 안해서 자동고침이 안된다
  "eslint.workingDirectories": [{ "mode": "auto" }]
}
```

## 실행

prettier, ESLint 실행 예시

```sh
# 수정할 내용이 있는지만 체크
pnpm prettier --check .
# 수정할 내용이 있으면 파일 수정
pnpm prettier --write .

# 경로 설정
pnpm eslint "src/**/*.{js,ts,tsx}" --fix
pnpm prettier --write "src/**/*.{js,ts,tsx}"

# 모노레포 전체에서 실행
pnpm eslint . --fix
pnpm prettier --write .

# Turborepo 사용 시 병렬 실행 가능
pnpm turbo run lint --parallel
pnpm turbo run format --parallel

# 특정 패키지에서만 실행
pnpm eslint apps/web --fix
pnpm prettier --write apps/web
```

> js 코드에서 주석으로 `// prettier-ignore`을 입력하면 다음 줄 구문이 prettier 문법이 적용되지 않은 상태로 출력이 됩니다.
